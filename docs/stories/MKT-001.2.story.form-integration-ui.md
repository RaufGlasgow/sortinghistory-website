# Story MKT-001.2: Form Integration and UI Feedback

## Summary
Connect HTML forms to the subscribe endpoint and add user feedback for success/error states.

## Parent Epic
MKT-001: Website Email Capture System

## Dependencies
- MKT-001.1 (Subscribe function must exist)

## Acceptance Criteria

### AC1: Forms Submit to API
- [ ] `index.html` form action points to `/api/subscribe`
- [ ] `features.html` form action points to `/api/subscribe`
- [ ] `compare/timeline-board-game.html` form action points to `/api/subscribe`
- [ ] Forms use JavaScript fetch instead of native submit (for feedback)

### AC2: Success State
- [ ] On success, form shows "You'll be notified at launch!"
- [ ] Success message is styled (green check or similar)
- [ ] Form input is disabled after success (prevent double submit)
- [ ] Button text changes to "Subscribed!"

### AC3: Error State
- [ ] On error, form shows error message from API
- [ ] Error message is styled (red, visible)
- [ ] User can retry after error

### AC4: Loading State
- [ ] Button shows loading indicator during submit
- [ ] Input is disabled during submit

## Technical Details

### JavaScript (add to each page or shared script)

```javascript
document.querySelectorAll('.notify-form').forEach(form => {
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const button = form.querySelector('button');
    const input = form.querySelector('input[type="email"]');
    const originalText = button.textContent;

    // Loading state
    button.textContent = 'Subscribing...';
    button.disabled = true;
    input.disabled = true;

    try {
      const response = await fetch('/api/subscribe', {
        method: 'POST',
        body: new FormData(form)
      });

      const data = await response.json();

      if (data.success) {
        // Success state
        button.textContent = 'Subscribed!';
        button.classList.add('notify-btn-success');
        input.value = '';
        showMessage(form, data.message, 'success');
      } else {
        // Error state
        button.textContent = originalText;
        button.disabled = false;
        input.disabled = false;
        showMessage(form, data.error, 'error');
      }
    } catch (error) {
      button.textContent = originalText;
      button.disabled = false;
      input.disabled = false;
      showMessage(form, 'Network error. Please try again.', 'error');
    }
  });
});

function showMessage(form, text, type) {
  // Remove existing message
  const existing = form.parentElement.querySelector('.notify-message');
  if (existing) existing.remove();

  const msg = document.createElement('p');
  msg.className = `notify-message notify-message-${type}`;
  msg.textContent = text;
  form.parentElement.insertBefore(msg, form.nextSibling);

  // Auto-remove error messages after 5s
  if (type === 'error') {
    setTimeout(() => msg.remove(), 5000);
  }
}
```

### CSS Additions

```css
.notify-btn-success {
  background: linear-gradient(135deg, #4CAF50, #45a049);
}

.notify-message {
  margin-top: 1rem;
  padding: 0.75rem 1rem;
  border-radius: 8px;
  font-size: 0.95rem;
}

.notify-message-success {
  background: rgba(76, 175, 80, 0.2);
  color: #4CAF50;
  border: 1px solid rgba(76, 175, 80, 0.3);
}

.notify-message-error {
  background: rgba(244, 67, 54, 0.2);
  color: #f44336;
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.notify-btn:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}
```

## Files to Modify
- `index.html` - Update form, add script
- `features.html` - Update form, add script
- `compare/timeline-board-game.html` - Update form, add script
- `styles.css` - Add feedback styles

## Out of Scope
- Admin export (Story 1.3)
- Email notification to owner (Story 1.3)

## Estimate
20 minutes

## Definition of Done
- [ ] All three forms submit via JavaScript
- [ ] Success state displays correctly
- [ ] Error state displays correctly
- [ ] Loading state prevents double-submit
- [ ] Tested on live site
